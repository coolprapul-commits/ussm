<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta charset="UTF-8">
<title>Service Status Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
    /* Modern animated background */
    body {
        min-height: 100vh;
        background: linear-gradient(120deg, #e0eafc 0%, #cfdef3 100%);
        font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
        position: relative;
        overflow-x: hidden;
    }
    body::before {
        content: '';
        position: fixed;
        top: -10%; left: -10%;
        width: 120vw; height: 120vh;
        background: radial-gradient(circle at 20% 30%, #3a7bd5 0%, transparent 60%),
                                radial-gradient(circle at 80% 70%, #00d2ff 0%, transparent 60%),
                                radial-gradient(circle at 60% 10%, #b8c6db 0%, transparent 70%);
        opacity: 0.25;
        z-index: 0;
        animation: bgmove 18s linear infinite alternate;
        pointer-events: none;
    }
    @keyframes bgmove {
        0% { transform: scale(1) translateY(0); }
        100% { transform: scale(1.1) translateY(30px); }
    }

    /* Left-side vertical navbar */
  .navbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 70px;
  min-width: 100vw;
  max-width: 100vw;
  background: linear-gradient(90deg, #3a7bd5 0%, #00d2ff 100%) !important;
  box-shadow: 0 4px 32px #3a7bd522;
  color: #fff !important;
  border-radius: 0 0 1.2rem 1.2rem;
  margin: 0;
  z-index: 2000;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
  padding: 0 2rem;
  transition: box-shadow 0.2s, background 0.2s;
  gap: 0;
  border-bottom: 2px solid #e0eafc;
  }
  .navbar-brand {
  font-size: 1.7rem;
  letter-spacing: 0.5px;
  margin-bottom: 2.5rem;
  text-align: left;
  width: 100%;
  background: linear-gradient(90deg, #fff, #e0eafc);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: bold;
  text-shadow: 0 2px 8px #3a7bd544;
  animation: gradientText 3s ease-in-out infinite alternate;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-start;
  gap: 0.7em;
  }
  .navbar-brand .logo {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: #fff;
    box-shadow: 0 2px 8px #3a7bd544;
    display: inline-block;
    margin-left: 0.5em;
    object-fit: cover;
  }
  @keyframes gradientText {
    0% { background-position: 0% 50%; }
    100% { background-position: 100% 50%; }
  }
  .navbar .logout-btn {
  background: linear-gradient(90deg, #e74c3c 0%, #f39c12 100%);
  color: #fff;
  font-weight: 900;
  border: none;
  box-shadow: 0 4px 16px #e74c3c44;
  margin-top: 0;
  width: auto;
  border-radius: 2rem;
  font-size: 1.25rem;
  padding: 1em 2.5em;
  transition: background 0.2s, box-shadow 0.2s, transform 0.2s;
  letter-spacing: 0.7px;
  outline: none;
  text-shadow: 0 3px 12px #c0392b99, 0 2px 4px #fff4;
  border: 2px solid #fff;
  }
  .navbar .logout-btn:hover {
  background: linear-gradient(90deg, #c0392b 0%, #f1c40f 100%);
  box-shadow: 0 8px 32px #e74c3c44;
  transform: translateY(-2px) scale(1.04);
  }
  #userLabel {
  background: linear-gradient(90deg, #00d2ff 0%, #3a7bd5 100%);
  color: #fff;
  font-size: 1.08rem;
  padding: 0.7em 1.5em;
  letter-spacing: 0.5px;
  text-shadow: 0 1px 2px #fff, 0 1px 2px #c0392b44;
  border: 2px solid #fff;
  margin-bottom: 0;
  margin-right: 0.5em;
  letter-spacing: 0.5px;
  animation: pulseUser 2s infinite alternate;
  text-align: center;
  width: auto;
  }
  @keyframes pulseUser {
    0% { box-shadow: 0 2px 8px #3a7bd544; }
    100% { box-shadow: 0 6px 24px #00d2ff44; }
  }
  /* Main content shifts left to accommodate navbar */
  .container {
  margin-left: 0;
  margin-top: 70px;
  transition: margin-top 0.3s;
  }
  @media (max-width: 991px) {
    .navbar {
      width: 100vw;
      min-width: 100vw;
      max-width: 100vw;
      height: auto;
      position: static;
      border-radius: 0;
      flex-direction: row;
      align-items: center;
      justify-content: flex-start;
      padding: 1rem 0.5rem;
    }
    .container {
      margin-left: 0;
    }
    .navbar-brand {
      font-size: 1.2rem !important;
      margin-bottom: 0;
      text-align: left;
      justify-content: flex-start;
    }
    #userLabel {
      margin-bottom: 0.5rem;
      text-align: left;
    }
    .navbar .logout-btn {
      margin-top: 0;
      width: auto;
      font-size: 1rem;
      padding: 0.5em 1em;
    }
  }
    .navbar {
        border-radius: 1.5rem;
        margin: 1.5rem auto 2rem auto;
        max-width: 1200px;
        box-shadow: 0 4px 32px #3a7bd522;
        background: rgba(255,255,255,0.85) !important;
        backdrop-filter: blur(6px);
        position: relative;
    }
    .navbar-brand {
        font-size: 1.7rem;
        letter-spacing: 0.5px;
    }
    .logout-btn {
    position: absolute;
    right: 0.5rem;
    top: 50%;
    transform: translateY(-50%);
    font-weight: 500;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 8px #e74c3c22;
    max-width: 120px;
    min-width: 90px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  @media (max-width: 991px) {
    .navbar .logout-btn {
      position: static !important;
      width: 100% !important;
      margin-bottom: 1rem !important;
      transform: none !important;
      max-width: 100vw !important;
      min-width: 80px;
      font-size: 1rem;
      white-space: normal;
    }
  }
    @media (max-width: 768px) {
        .navbar {
      border-radius: 0 !important;
      margin: 0 !important;
      width: 100vw !important;
      max-width: 100vw !important;
      padding-left: 0 !important;
      padding-right: 0 !important;
      min-width: 100vw !important;
    }
    .container-fluid {
      width: 100vw !important;
      max-width: 100vw !important;
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
    .navbar-brand {
      font-size: 1.2rem !important;
      word-break: break-word;
      max-width: 70vw;
    }
    .logout-btn {
      position: static !important;
      width: 100% !important;
      margin-bottom: 1rem !important;
      transform: none !important;
    }
    }

    .container {
        width: 100%;
    max-width: 100vw;
    min-height: 100vh;
    box-sizing: border-box;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
    }
    @media (max-width: 1200px) {
    .container {
      max-width: 100vw;
      padding-left: 0.2rem;
      padding-right: 0.2rem;
    }
  }
    @media (max-width: 768px) {
    .container, .navbar, .analytics-card, #serviceCards > div {
      max-width: 100vw !important;
      width: 100vw !important;
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
    .navbar {
      border-radius: 0 !important;
      margin: 0 !important;
    }
    .analytics-card {
      margin: 0 auto 1rem auto !important;
    }
    #serviceCards > div {
      margin-left: 0 !important;
      margin-right: 0 !important;
    }
  }
    .search-bar { max-width: 320px; border-radius: 1.5rem; }
    .form-select, .form-control { border-radius: 1.5rem; }

    .card {
  /* Floating Add Service Button */
  .add-service-fab {
  position: fixed;
  left: 50%;
  bottom: 2.2rem;
  transform: translateX(-50%);
  z-index: 1000;
    border-radius: 2rem;
    min-width: 160px;
    height: 48px;
    box-shadow: 0 4px 18px #3a7bd544;
    font-size: 1.15rem;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 1.5rem;
    font-weight: 600;
    background: linear-gradient(90deg, #3a7bd5, #00d2ff);
    color: #fff;
    border: none;
    transition: box-shadow 0.2s, background 0.2s;
    cursor: pointer;
    gap: 0.7em;
  }
  .add-service-fab:hover {
    background: linear-gradient(90deg, #245ea8, #3a7bd5);
    color: #fff;
    box-shadow: 0 8px 32px #3a7bd544;
  }
  @media (max-width: 600px) {
    .add-service-fab {
      min-width: 120px;
      height: 40px;
      font-size: 1em;
      bottom: 1rem;
    }
  }
    border: none;
    border-radius: 1.5rem;
    background: rgba(255,255,255,0.75);
    box-shadow: 0 6px 32px #3a7bd522, 0 1.5px 6px #b8c6db33;
    transition: box-shadow 0.2s, transform 0.2s;
    margin-bottom: 1.5rem;
    backdrop-filter: blur(4px);
  }

  /* Shrink analytics card and pie chart */
  .analytics-card {
  max-width: 280px;
  margin-left: auto;
  margin-right: 0;
  padding: 1.3rem 1.2rem 1rem 1.2rem;
  background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%) !important;
  border-radius: 1.5rem;
  box-shadow: 0 8px 32px #3a7bd544, 0 1.5px 6px #b8c6db33;
  backdrop-filter: blur(6px);
  border: 2px solid #3a7bd5;
  position: relative;
  overflow: hidden;
  animation: glowCard 2.5s infinite alternate;
  }
  #statusPieChart {
  max-width: 200px;
  max-height: 200px;
  margin: 0 auto 0.5em auto;
  display: block;
  background: rgba(255,255,255,0.95);
  border-radius: 1.2rem;
  box-shadow: 0 4px 18px #3a7bd544;
  padding: 1.2em;
  border: 2px solid #3a7bd5;
  }
  @media (max-width: 991px) {
  .analytics-card { max-width: 100%; margin: 0 auto 1rem auto; }
  #statusPieChart { max-width: 120px; max-height: 120px; }
  .analytics-card { padding: 1em 0.5em 0.7em 0.5em; }
  }
  .card:hover {
      box-shadow: 0 8px 40px #3a7bd544, 0 2px 8px #b8c6db44;
      transform: translateY(-2px) scale(1.015);
  }
    .card-title {
        font-weight: 700;
        font-size: 1.2rem;
        color: #232a34;
        letter-spacing: 0.2px;
    }
    .card-title {
    font-weight: 700;
    font-size: 1.2rem;
    color: #232a34;
    letter-spacing: 0.2px;
    display: flex;
    align-items: center;
    gap: 0.5em;
  }
  .card-title i {
    color: #3a7bd5;
    font-size: 1.1em;
    margin-right: 0.3em;
  }
    .card-subtitle {
        color: #3a7bd5;
        font-weight: 500;
        font-size: 1rem;
    }
    .status-badge {
        font-weight: 600;
        border-radius: 1rem;
        padding: 0.3em 1.1em;
        font-size: 1em;
        box-shadow: 0 1px 6px #b8c6db33;
        margin-top: 0.5em;
        display: inline-block;
        transition: background 0.2s;
    }
  .status-operational { background: linear-gradient(90deg, #2ecc40, #27ae60); color: #fff; }
  .status-partial { background: linear-gradient(90deg, #f1c40f, #f39c12); color: #232a34; }
  .status-down { background: linear-gradient(90deg, #e74c3c, #c0392b); color: #fff; }
  .status-maintenance { background: linear-gradient(90deg, #3498db, #2980b9); color: #fff; }
  .status-investigation { background: linear-gradient(90deg, #232a34, #232a34); color: #fff; }

    .modal-content {
        border-radius: 1.2rem;
        box-shadow: 0 4px 32px #3a7bd522;
        background: rgba(255,255,255,0.97);
        backdrop-filter: blur(4px);
    }
    .modal-title {
        font-weight: 700;
        color: #3a7bd5;
    }
    .btn-primary, .btn-success, .btn-secondary {
        border-radius: 1.5rem;
        font-weight: 600;
        letter-spacing: 0.2px;
        box-shadow: 0 2px 8px #3a7bd522;
    }
    .btn-outline-primary {
        border-radius: 1.5rem;
        font-weight: 600;
        letter-spacing: 0.2px;
    }
    .form-label {
        font-weight: 500;
        color: #3a7bd5;
    }
    .form-check-label {
        font-weight: 500;
        color: #232a34;
    }
    .fa-server {
        filter: drop-shadow(0 2px 8px #3a7bd522);
    }
    .fa-edit {
        color: #3a7bd5;
    }
    /* Subtle fade-in for cards */
    #serviceCards > div {
        animation: fadein 0.7s cubic-bezier(.39,.575,.565,1) both;
    }
    @keyframes fadein {
        0% { opacity: 0; transform: translateY(20px) scale(0.98); }
        100% { opacity: 1; transform: none; }
    }

  /* Sticky vertical Add Service Button */
.add-service-fab {
      position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1000;
  padding: 12px 24px;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 25px;
  cursor: pointer;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: none; /* no hover transitions */
}

@media (max-width: 600px) {
    .add-service-fab {
      min-width: 120px;
      height: 40px;
      font-size: 1em;
      bottom: 1rem;
    }
  }
  @media (max-width: 600px) {
    .add-service-fab {
      min-width: 36px;
      height: 120px;
      font-size: 0.98em;
      padding: 0 0.2rem;
    }
  }

  @media (max-width: 1200px) {
    .navbar, .container-fluid {
      width: 100vw !important;
      max-width: 100vw !important;
      min-width: 100vw !important;
      margin: 0 !important;
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
  }
  @media (max-width: 768px) {
    .navbar, .container-fluid {
      width: 100vw !important;
      max-width: 100vw !important;
      min-width: 100vw !important;
      margin: 0 !important;
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
    .navbar-brand {
      font-size: 1.2rem !important;
      word-break: break-word;
      max-width: 70vw;
    }
    .logout-btn {
      position: static !important;
      width: 100% !important;
      margin-bottom: 1rem !important;
      transform: none !important;
    }
  }
  .navbar {
    width: 100vw !important;
    max-width: 100vw !important;
    min-width: 100vw !important;
    margin: 0 !important;
    left: 0 !important;
    right: 0 !important;
    border-radius: 0 !important;
  }
  .container-fluid {
    width: 100vw !important;
    max-width: 100vw !important;
    min-width: 100vw !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  .navbar .d-flex.align-items-center.gap-3 {
    gap: 2.5rem !important;
    margin-right: 2rem;
    justify-content: flex-end;
  }
  .navbar .logout-btn {
    right: 0.5rem;
    margin-left: 1.5rem;
  }
  #userLabel {
    margin-left: 1.5rem;
  }
  @media (max-width: 991px) {
    .navbar .d-flex.align-items-center.gap-3 {
      margin-right: 0.5rem;
      gap: 1.2rem !important;
    }
    #userLabel {
      margin-left: 0.5rem;
    }
    .navbar .logout-btn {
      margin-left: 0.5rem;
    }
  }

  /* Professional search bar styling */
  .search-bar {
    border-radius: 2rem;
    border: 2px solid #3a7bd5;
    font-size: 1.08rem;
    padding: 0.7em 1.5em;
    background: #f8f9fa;
    box-shadow: 0 2px 8px #3a7bd544;
    transition: box-shadow 0.2s, border-color 0.2s;
    outline: none;
  }
  .search-bar:focus {
    border-color: #00d2ff;
    box-shadow: 0 4px 16px #00d2ff44;
    background: #fff;
  }
  /* Professional button styling */
  .btn {
    font-size: 1.08rem;
    font-weight: 600;
    border-radius: 2rem;
    padding: 0.7em 2em;
    letter-spacing: 0.2px;
    box-shadow: 0 2px 8px #3a7bd544;
    transition: background 0.2s, box-shadow 0.2s, border-color 0.2s;
    outline: none;
    border: none;
  }
  .btn-primary {
    background: linear-gradient(90deg, #3a7bd5, #00d2ff);
    color: #fff;
  }
  .btn-info {
    background: linear-gradient(90deg, #00d2ff, #3a7bd5);
    color: #fff;
  }
  .btn-success {
    background: linear-gradient(90deg, #27ae60, #2ecc40);
    color: #fff;
  }
  .btn-secondary {
    background: linear-gradient(90deg, #b8c6db, #e0eafc);
    color: #232a34;
  }
  .btn-outline-primary {
    border: 2px solid #3a7bd5;
    color: #3a7bd5;
    background: #fff;
  }
  .btn:hover, .btn:focus {
    box-shadow: 0 4px 16px #00d2ff44;
    opacity: 0.97;
    border-color: #00d2ff;
  }
  /* Accessible focus ring for buttons and search bar */
  .btn:focus, .search-bar:focus {
    outline: 2px solid #00d2ff;
    outline-offset: 2px;
  }
  </style>
</head>
<body>
  <!-- Designer background -->
  <div class="designer-bg">
    <div class="shape shape1"></div>
    <div class="shape shape2"></div>
    <div class="shape shape3"></div>
    <div class="glass-overlay"></div>
  </div>
  <nav class="navbar navbar-light bg-white shadow-sm mb-4">
    <div class="d-flex w-100 align-items-center justify-content-between">
      <div class="navbar-brand mb-0 h1 d-flex align-items-center" style="gap:1em;">
        <img src="https://cdn-icons-png.flaticon.com/512/2919/2919600.png" alt="Logo" class="logo" />
        <span style="background: linear-gradient(90deg, #3a7bd5, #00d2ff); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; margin-left: 0.7em; font-size:1.5rem;">
          Service Status Dashboard
        </span>
      </div>
      <ul class="nav nav-pills flex-row" style="gap:1.5em; margin-bottom:0;">
        <li class="nav-item">
          <a class="nav-link active d-flex align-items-center" href="#" style="font-size:1.08rem;gap:0.5em;background:rgba(255,255,255,0.12);color:#fff;font-weight:600;border-radius:1.2rem;">
            <i class="fa fa-dashboard"></i> Dashboard
          </a>
        </li>
      </ul>
      <div class="d-flex align-items-center ms-auto" style="gap:1em;">
        <span id="userLabel" class="badge bg-primary text-light fs-6 px-3 py-2" style="letter-spacing:0.5px; font-size:1.08rem;">User</span>
        <button class="btn btn-outline-danger logout-btn d-flex align-items-center" style="position:static;transform:none;gap:0.7em;padding:0.7em 1.7em 0.7em 1.2em;" id="logoutBtn">
          <i class="fa fa-sign-out-alt" style="font-size:1.2em;"></i>
          <span style="font-weight:700;"></span>
        </button>
      </div>
    </div>
  </nav>
  <div class="container">
    <div class="row mb-4 align-items-center">
      <div class="col-lg-8 col-md-7 col-12 mb-3 mb-md-0 d-flex flex-wrap gap-3 align-items-end">
        <input id="searchInput" class="form-control search-bar" placeholder="Search by name..." style="max-width: 320px;">
        <select id="statusFilter" class="form-select" style="max-width: 200px;">
          <option value="">All Statuses</option>
          <option value="Operational">Operational</option>
          <option value="Partial Outage">Partial Outage</option>
          <option value="Down">Down</option>
          <option value="Planned Maintenance">Planned Maintenance</option>
          <option value="Under Investigation">Under Investigation</option>
        </select>
        <button id="favToggle" class="btn btn-outline-primary ms-2" style="font-weight:600;display:none;">Show My Favourites</button>
  <button class="btn btn-secondary d-none" id="customizeBtn"><i class="fa fa-sliders me-1"></i> Customize My Dashboard</button>
      </div>
      <div class="col-lg-4 col-md-5 col-12 mb-3 mb-md-0">
        <!-- Service Status Analytics Card -->
        <div class="card analytics-card p-2 shadow-sm" style="background:rgba(255,255,255,0.92);">
          <div class="fw-bold mb-2 text-center d-flex align-items-center justify-content-center" style="color:#245ea8; font-size:1.18rem; gap:0.5em;">
            <i class="fa fa-chart-pie" style="font-size:1.3em; color:#3a7bd5; filter: drop-shadow(0 2px 8px #3a7bd544);"></i>
            <span style="background: linear-gradient(90deg, #3a7bd5, #00d2ff); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold;">Service Status Analytics</span>
          </div>
          <canvas id="statusPieChart" height="120"></canvas>
          <div class="pie-legend" id="pieLegend" style="margin-top:0.5em;"></div>
          <div class="analytics-glow"></div>
        </div>

      </div>
    </div>
    <div class="row" id="serviceCards"></div>
  </div>




<!-- Floating Add Service Button (FAB) for admin/developer only -->
<button class="add-service-fab shadow-lg" id="addServiceBtn"
  title="Add Service" aria-label="Add Service" tabindex="0" style="display:none; position:fixed; bottom:32px; right:32px; z-index:1050; background:#3a7bd5; color:#fff; border-radius:2.5em; padding:1em 2em; font-size:1.1em; font-weight:600; box-shadow:0 4px 24px #3a7bd544;">
  <span style="font-size:1.1em; font-weight:600;">Add Service</span>
</button>


  <!-- Add/Edit Service Modal -->
  <div class="modal fade" id="serviceModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="serviceForm">
          <div class="modal-header">
            <h5 class="modal-title" id="serviceModalTitle">Add/Edit Service</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
            <div class="mb-3">
              <label for="serviceUrl" class="form-label">Service URL (optional)</label>
              <input type="url" class="form-control" id="serviceUrl" placeholder="https://example.com">
            </div>
              <label for="serviceName" class="form-label">Service Name</label>
              <input type="text" class="form-control" id="serviceName" required>
            </div>
            <div class="mb-3">
              <label for="serviceType" class="form-label">Type</label>
              <select class="form-select" id="serviceType" required>
                <option value="Internal">Internal</option>
                <option value="External">External</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="serviceStatus" class="form-label">Status</label>
              <select class="form-select" id="serviceStatus" required onchange="toggleMaintenanceFields()">
                <option value="Operational">Operational</option>
                <option value="Partial Outage">Partial Outage</option>
                <option value="Down">Down</option>
                <option value="Planned Maintenance">Planned Maintenance</option>
                <option value="Under Investigation">Under Investigation</option>
              </select>
            </div>
            <div class="mb-3" id="maintenanceTimeFields" style="display:none;">
              <label class="form-label">Planned Maintenance Window</label>
              <div class="row g-2">
                <div class="col-6">
                  <input type="datetime-local" class="form-control" id="maintenanceStart" placeholder="Start Time">
                </div>
                <div class="col-6">
                  <input type="datetime-local" class="form-control" id="maintenanceEnd" placeholder="End Time">
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Customize Dashboard Modal -->
  <div class="modal fade" id="customizeModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="customizeForm">
          <div class="modal-header">
            <h5 class="modal-title">Customize My Dashboard</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body" id="customizeList">
            <!-- Service checkboxes will be rendered here -->
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add User button for admin only -->
      <button class="btn btn-success ms-2" id="addUserBtn" style="display:none;"><i class="fa fa-user-plus me-1"></i> Add User</button>

  <!-- Add User Modal -->
  <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addUserForm">
          <div class="modal-header">
            <h5 class="modal-title" id="addUserModalLabel">Add New User</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="newUsername" class="form-label">Username</label>
              <input type="text" class="form-control" id="newUsername" required>
            </div>
            <div class="mb-3">
              <label for="newPassword" class="form-label">Password</label>
              <input type="password" class="form-control" id="newPassword" required>
            </div>
            <div class="mb-3">
              <label for="newRole" class="form-label">Role</label>
              <select class="form-select" id="newRole" required>
                <option value="admin">Admin</option>
                <option value="developer">Developer</option>
                <option value="user">User</option>
              </select>
            </div>
            <div id="addUserError" class="text-danger"></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-success">Add User</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="dashboard.js"></script>
  <script>

    // Display username and role in navbar
    let username = localStorage.getItem('ussm_user') || '';
    let role = localStorage.getItem('ussm_role') || 'user';
    if (role === 'admin') {
      document.getElementById('userLabel').textContent = username ? `${username} (Admin)` : 'Admin';
    } else if (role === 'developer') {
      document.getElementById('userLabel').textContent = username ? `${username} (Developer)` : 'Developer';
    } else {
      document.getElementById('userLabel').textContent = username ? username : 'User';
    }
    // Show Add Service button only for admin/developer (floating FAB)
    var addBtn = document.getElementById('addServiceBtn');
    if (role === 'admin' || role === 'developer') {
      addBtn.style.display = '';
      addBtn.disabled = false;
      // Add event listeners to open modal
      addBtn.onclick = function(e) {
        e.preventDefault();
        var serviceModal = new bootstrap.Modal(document.getElementById('serviceModal'));
        document.getElementById('serviceForm').reset();
        document.getElementById('serviceModalTitle').textContent = 'Add Service';
        serviceModal.show();
      };
      addBtn.onkeydown = function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          var serviceModal = new bootstrap.Modal(document.getElementById('serviceModal'));
          document.getElementById('serviceForm').reset();
          document.getElementById('serviceModalTitle').textContent = 'Add Service';
          serviceModal.show();
        }
      };
    } else {
      addBtn.style.display = 'none';
      addBtn.disabled = true;
    }
    // Show Add User button only for admin
    if (role === 'admin') {
      document.getElementById('addUserBtn').style.display = '';
    }
    // Logout is handled in dashboard.js

function toggleMaintenanceFields() {
  var status = document.getElementById('serviceStatus').value;
  var fields = document.getElementById('maintenanceTimeFields');
  if (status === 'Planned Maintenance') {
    fields.style.display = '';
  } else {
    fields.style.display = 'none';
  }
}
// Show fields if editing a Planned Maintenance service
if (window.location.pathname.endsWith('dashboard.html')) {
  document.addEventListener('DOMContentLoaded', function() {
    var statusSel = document.getElementById('serviceStatus');
    if (statusSel) {
      statusSel.addEventListener('change', toggleMaintenanceFields);
      toggleMaintenanceFields();
    }
  });
}

// Show Add User button only for admin
if (role === 'admin') {
  document.getElementById('addUserBtn').style.display = '';
}

// Modal logic
const addUserBtn = document.getElementById('addUserBtn');
const addUserModal = new bootstrap.Modal(document.getElementById('addUserModal'));
addUserBtn.addEventListener('click', () => {
  document.getElementById('addUserForm').reset();
  document.getElementById('addUserError').textContent = '';
  addUserModal.show();
});

// Handle Add User form submit
const addUserForm = document.getElementById('addUserForm');
addUserForm.onsubmit = async function(e) {
  e.preventDefault();
  const username = document.getElementById('newUsername').value.trim();
  const password = document.getElementById('newPassword').value;
  const role = document.getElementById('newRole').value;
  try {
    const res = await fetch('http://localhost:3001/api/users', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password, role })
    });
    if (!res.ok) {
      const data = await res.json();
      throw new Error(data.message || 'Failed to add user');
    }
    addUserModal.hide();
    alert('User added successfully!');
  } catch (err) {
    document.getElementById('addUserError').textContent = err.message;
  }
};

// Render pie chart legend for clarity

/**
 * Renders the pie chart legend for service statuses.
 * Each status is shown with its color and label.
 */

  </script>
  <!-- Chart rendering is handled in dashboard.js. No inline chart logic here. -->
</body>
</html>
